testTrial$thumbZvel <- with(testTrial, kin.derive(time,thumbZ,d=1))
testTrial$thumbVel <- with(testTrial, sqrt(thumbXvel^2 + thumbYvel^2 + thumbZvel^2)) # in mm/s
testTrial$thumbXvel2 <- with(testTrial, kin.sgFilter(thumbX,m=1, ts = .01))
testTrial$thumbYvel2 <- with(testTrial, kin.sgFilter(thumbY,m=1, ts = .01))
testTrial$thumbZvel2 <- with(testTrial, kin.sgFilter(thumbZ,m=1, ts = .01))
testTrial$thumbVel2 <- with(testTrial, sqrt(thumbXvel2^2 + thumbYvel2^2 + thumbZvel2^2)) # in mm/s
ggplot(data = testTrial) +
geom_point(aes(time, thumbVel), color = "black") +
geom_point(aes(time, thumbVel2), color = "red", alpha = .5)
testTrial$thumbXvel2 <- with(testTrial, kin.sgFilter(thumbX,m=1, ts = .1))
testTrial$thumbYvel2 <- with(testTrial, kin.sgFilter(thumbY,m=1, ts = .1))
testTrial$thumbZvel2 <- with(testTrial, kin.sgFilter(thumbZ,m=1, ts = .1))
testTrial$thumbVel2 <- with(testTrial, sqrt(thumbXvel2^2 + thumbYvel2^2 + thumbZvel2^2)) # in mm/s
ggplot(data = testTrial) +
geom_point(aes(time, thumbVel), color = "black") +
geom_point(aes(time, thumbVel2), color = "red", alpha = .5)
ggplot(data = testTrial) +
geom_point(aes(time, thumbX), color = "black") +
geom_point(aes(time, thumbXVel2), color = "red", alpha = .5)
testTrial$thumbXvel2 <- with(testTrial, kin.sgFilter(thumbX,m=1, ts = .1))
testTrial$thumbYvel2 <- with(testTrial, kin.sgFilter(thumbY,m=1, ts = .1))
testTrial$thumbZvel2 <- with(testTrial, kin.sgFilter(thumbZ,m=1, ts = .1))
testTrial$thumbVel2 <- with(testTrial, sqrt(thumbXvel2^2 + thumbYvel2^2 + thumbZvel2^2)) # in mm/s
ggplot(data = testTrial) +
geom_point(aes(time, thumbX), color = "black") +
geom_point(aes(time, thumbXVel2), color = "red", alpha = .5)
ggplot(data = testTrial) +
geom_point(aes(time, thumbX), color = "black") +
geom_point(aes(time, thumbXvel2), color = "red", alpha = .5)
300 * .01
testTrial$thumbXvel2 <- with(testTrial, kin.sgFilter(thumbX,m=1, ts = .1))
testTrial$thumbYvel2 <- with(testTrial, kin.sgFilter(thumbY,m=1, ts = .1))
testTrial$thumbZvel2 <- with(testTrial, kin.sgFilter(thumbZ,m=1, ts = .1))
testTrial$thumbVel2 <- with(testTrial, sqrt(thumbXvel2^2 + thumbYvel2^2 + thumbZvel2^2)) # in mm/s
ggplot(data = testTrial) +
geom_point(aes(time, thumbX), color = "black") +
geom_point(aes(time, thumbXvel2), color = "red", alpha = .5)
testTrial$thumbXvel2 <- with(testTrial, kin.sgFilter(thumbX,m=1, ts = 1))
testTrial$thumbYvel2 <- with(testTrial, kin.sgFilter(thumbY,m=1, ts = 1))
testTrial$thumbZvel2 <- with(testTrial, kin.sgFilter(thumbZ,m=1, ts = 1))
testTrial$thumbVel2 <- with(testTrial, sqrt(thumbXvel2^2 + thumbYvel2^2 + thumbZvel2^2)) # in mm/s
ggplot(data = testTrial) +
geom_point(aes(time, thumbX), color = "black") +
geom_point(aes(time, thumbXvel2), color = "red", alpha = .5)
testTrial$thumbXvel2 <- with(testTrial, kin.sgFilter(thumbX,m=1, ts = .01))
testTrial$thumbYvel2 <- with(testTrial, kin.sgFilter(thumbY,m=1, ts = .01))
testTrial$thumbZvel2 <- with(testTrial, kin.sgFilter(thumbZ,m=1, ts = .01))
testTrial$thumbVel2 <- with(testTrial, sqrt(thumbXvel2^2 + thumbYvel2^2 + thumbZvel2^2)) # in mm/s
300 * .01
ggplot(data = testTrial) +
geom_point(aes(time, thumbX), color = "black") +
geom_point(aes(time, thumbXvel2), color = "red", alpha = .5)
ggplot(data = testTrial) +
geom_point(aes(time, thumbX), color = "black") +
geom_point(aes(time, thumbXvel), color = "red", alpha = .5)
testTrial$thumbXvel <- with(testTrial, kin.derive(frameN,thumbX,d=1) / frameT)
testTrial$thumbYvel <- with(testTrial, kin.derive(frameN,thumbY,d=1) / frameT)
testTrial$thumbZvel <- with(testTrial, kin.derive(frameN,thumbZ,d=1) / frameT)
testTrial$thumbVel <- with(testTrial, sqrt(thumbXvel^2 + thumbYvel^2 + thumbZvel^2)) # in mm/s
ggplot(data = testTrial) +
geom_point(aes(time, thumbX), color = "black") +
geom_point(aes(time, thumbXvel), color = "red", alpha = .5)
1/85
testTrial$thumbXvel2 <- with(testTrial, kin.sgFilter(thumbX,m=1, ts = 1/85))
testTrial$thumbYvel2 <- with(testTrial, kin.sgFilter(thumbY,m=1, ts = 1/85))
testTrial$thumbZvel2 <- with(testTrial, kin.sgFilter(thumbZ,m=1, ts = 1/85))
testTrial$thumbVel2 <- with(testTrial, sqrt(thumbXvel2^2 + thumbYvel2^2 + thumbZvel2^2)) # in mm/s
ggplot(data = testTrial) +
geom_point(aes(time, thumbX), color = "black") +
geom_point(aes(time, thumbXvel), color = "red", alpha = .5)
ggplot(data = testTrial) +
geom_point(aes(time, thumbXvel), color = "black") +
geom_point(aes(time, thumbXvel2), color = "red", alpha = .5)
testTrial$indexXsg <- with(testTrial, kin.sgFilter(indexXrep, ts = 1/85))
testTrial$indexYsg <- with(testTrial, kin.sgFilter(indexYrep, ts = 1/85))
testTrial$indexZsg <- with(testTrial, kin.sgFilter(indexZrep, ts = 1/85))
testTrial$thumbXsg <- with(testTrial, kin.sgFilter(thumbXrep, ts = 1/85))
testTrial$thumbYsg <- with(testTrial, kin.sgFilter(thumbYrep, ts = 1/85))
testTrial$thumbZsg <- with(testTrial, kin.sgFilter(thumbZrep, ts = 1/85))
ggplot(data = testTrial) +
geom_point(aes(frameN, thumbXrep), color = "black") +
geom_point(aes(frameN, thumbXsg), color = "green", alpha=.5)
qplot(indexXbw-indexXrep, indexXsg-indexXrep, data=testTrial, geom="point") + coord_fixed()
qplot(thumbXbw-thumbXrep, thumbXsg-thumbXrep, data=testTrial, geom="point") + coord_fixed()
testTrial$thumbXsg <- with(testTrial, kin.sgFilter(thumbXrep))
testTrial$thumbYsg <- with(testTrial, kin.sgFilter(thumbYrep))
testTrial$thumbZsg <- with(testTrial, kin.sgFilter(thumbZrep))
ggplot(data = testTrial) +
geom_point(aes(frameN, thumbXrep), color = "black") +
geom_point(aes(frameN, thumbXsg), color = "green", alpha=.5)
qplot(thumbXbw-thumbXrep, thumbXsg-thumbXrep, data=testTrial, geom="point") + coord_fixed()
testTrial$frameT
testTrial$thumbXvel2 <- with(testTrial, kin.sgFilter(thumbX,m=1, ts = frameT))
testTrial$thumbYvel2 <- with(testTrial, kin.sgFilter(thumbY,m=1, ts = frameT))
testTrial$thumbXvel2 <- with(testTrial, kin.sgFilter(thumbX,m=1, ts = 1/85))
testTrial$thumbYvel2 <- with(testTrial, kin.sgFilter(thumbY,m=1, ts = 1/85))
testTrial$thumbZvel2 <- with(testTrial, kin.sgFilter(thumbZ,m=1, ts = 1/85))
testTrial$thumbVel2 <- with(testTrial, sqrt(thumbXvel2^2 + thumbYvel2^2 + thumbZvel2^2)) # in mm/s
ggplot(data = testTrial) +
geom_point(aes(time, thumbXvel), color = "black") +
geom_point(aes(time, thumbXvel2), color = "red", alpha = .5)
testTrial$thumbXvel <- with(testTrial, kin.sgFilter(thumbX,m=1, ts = 1/85))
testTrial$thumbYvel <- with(testTrial, kin.sgFilter(thumbY,m=1, ts = 1/85))
testTrial$thumbZvel <- with(testTrial, kin.sgFilter(thumbZ,m=1, ts = 1/85))
testTrial$thumbvel <- with(testTrial, sqrt(thumbXvel^2 + thumbYvel^2 + thumbZvel^2)) # in mm/s
ggplot(data = testTrial) +
geom_point(aes(time, thumbVel), color = "black") +
geom_point(aes(time, thumbVel2), color = "red", alpha = .5)
testTrial$thumbVel <- with(testTrial, kin.bwFilter(thumbVel, cutoff_freq = 10, type = "pass"))
ggplot(data = testTrial) +
geom_point(aes(time, thumbVel), color = "black") +
geom_point(aes(time, thumbVel2), color = "red", alpha = .5)
testTrial$thumbVel <- with(testTrial, kin.sgFilter(thumbVel, ts = 1/85))
ggplot(data = testTrial) +
geom_point(aes(time, thumbVel), color = "black") +
geom_point(aes(time, thumbVel2), color = "red", alpha = .5)
testTrial$thumbVel <- with(testTrial, kin.bwFilter(thumbVel, cutoff_freq = 10, type = "pass"))
ggplot(data = testTrial) +
geom_point(aes(time, thumbVel), color = "black") +
geom_point(aes(time, thumbVel2), color = "red", alpha = .5)
testTrial$thumbVel <- with(testTrial, kin.sgFilter(thumbVel, ts = 1/85))
ggplot(data = testTrial) +
geom_point(aes(time, thumbVel), color = "black") +
geom_point(aes(time, thumbVel2), color = "red", alpha = .5)
testTrial$thumbvel <- with(testTrial, sqrt(thumbXvel^2 + thumbYvel^2 + thumbZvel^2)) # in mm/s
testTrial$thumbVel <- with(testTrial, kin.bwFilter(thumbVel, cutoff_freq = 10, type = "pass"))
ggplot(data = testTrial) +
geom_point(aes(time, thumbVel), color = "black") +
geom_point(aes(time, thumbVel2), color = "red", alpha = .5)
testTrial$thumbvel <- with(testTrial, sqrt(thumbXvel^2 + thumbYvel^2 + thumbZvel^2)) # in mm/s
testTrial$thumbVel <- with(testTrial, kin.sgFilter(thumbVel, ts = 1/85))
ggplot(data = testTrial) +
geom_point(aes(time, thumbVel), color = "black") +
geom_point(aes(time, thumbVel2), color = "red", alpha = .5)
testTrial$thumbAcc <- with(testTrial, kin.derive(frameN,thumbVel,d=1) / frameT)
testTrial$thumbAcc <- with(testTrial, kin.bwFilter(thumbAcc, cutoff_freq = 10, type = "pass"))
testTrial$thumbAcc2 <- with(testTrial, kin.sgFilter(frameN,thumbVel, m=1, ts = 1/85))
testTrial$thumbAcc2 <- with(testTrial, kin.sgFilter(frameN,thumbAcc, ts = 1/85))
testTrial$thumbAcc2 <- with(testTrial, kin.sgFilter(thumbVel, m=1, ts = 1/85))
testTrial$thumbAcc2 <- with(testTrial, kin.sgFilter(thumbAcc, ts = 1/85))
ggplot(data = testTrial) +
geom_point(aes(time, thumbAcc), color = "black") +
geom_point(aes(time, thumbAcc2), color = "red", alpha = .5)
testTrial$thumbAcc <- with(testTrial, kin.sgFilter(thumbVel, m=1, ts = 1/85))
testTrial$thumbAcc <- with(testTrial, kin.sgFilter(thumbAcc, ts = 1/85))
ggplot(data = testTrial) +
geom_point(aes(time, thumbAcc), color = "black") +
geom_point(aes(time, thumbAcc2), color = "red", alpha = .5)
testTrial$thumbAcc <- with(testTrial, kin.derive(frameN,thumbVel,d=1) / frameT)
testTrial$thumbAcc <- with(testTrial, kin.bwFilter(thumbAcc, cutoff_freq = 10, type = "pass"))
testTrial$thumbAcc2 <- with(testTrial, kin.sgFilter(thumbVel, m=1, ts = 1/85))
testTrial$thumbAcc2 <- with(testTrial, kin.sgFilter(thumbAcc, ts = 1/85))
ggplot(data = testTrial) +
geom_point(aes(time, thumbAcc), color = "black") +
geom_point(aes(time, thumbAcc2), color = "red", alpha = .5)
testTrial$thumbAcc <- with(testTrial, kin.sgFilter(thumbVel, m=1, ts = 1/85))
testTrial$thumbAcc <- with(testTrial, kin.sgFilter(thumbAcc, ts = 1/85))
ggplot(data = testTrial) +
geom_point(aes(time, thumbAcc), color = "black") +
geom_point(aes(time, thumbAcc2), color = "red", alpha = .5)
ggplot(data = testTrial) +
geom_point(aes(time, thumbXvel), color = "red") +
geom_point(aes(time, thumbYvel), color = "darkgreen") +
geom_point(aes(time, thumbZvel), color = "blue") +
geom_point(aes(time, thumbVel), color = "black")
?sgolayfilt
?sreg
library(kinesis)
options(scipen = 1, digits = 3)
libraries()
library(cowplot)
usefCols <- c("trialN","indexXraw","indexYraw","indexZraw","thumbXraw","thumbYraw","thumbZraw")
testData <- rtgData_bad[usefCols]
testData <- kin.frameN(testData)
testData <- kin.fingersOccluded(testData)
any(testData$fingersOccluded==1) # YES
testData <- kin.framesOccluded(testData)
testData$frameT <- 1/85
testData$time <- testData$frameN * testData$frameT
testData <- ddply(testData, .(trialN), mutate,
missing.frames = any(framesOccluded > 0))
trial.na.frame <- unique(subset(testData, missing.frames)$trialN)
badTrialNum <- 40
testTrial <- subset(testData, trialN == badTrialNum)
max(testTrial$framesOccluded) # 15
testTrial$indexXrep <- with(testTrial, kin.smooth.repair(frameN,indexXraw, lam = 10e-18, maxFrames= 20, fingersOccluded=fingersOccluded, framesOccluded=framesOccluded))
testTrial$indexYrep <- with(testTrial, kin.smooth.repair(frameN,indexYraw, lam = 10e-18, maxFrames= 20, fingersOccluded=fingersOccluded, framesOccluded=framesOccluded))
testTrial$indexZrep <- with(testTrial, kin.smooth.repair(frameN,indexZraw, lam = 10e-18, maxFrames= 20, fingersOccluded=fingersOccluded, framesOccluded=framesOccluded))
testTrial$thumbXrep <- with(testTrial, kin.smooth.repair(frameN,thumbXraw, lam = 10e-18, maxFrames= 20, fingersOccluded=fingersOccluded, framesOccluded=framesOccluded))
testTrial$thumbYrep <- with(testTrial, kin.smooth.repair(frameN,thumbYraw, lam = 10e-18, maxFrames= 20, fingersOccluded=fingersOccluded, framesOccluded=framesOccluded))
testTrial$thumbZrep <- with(testTrial, kin.smooth.repair(frameN,thumbZraw, lam = 10e-18, maxFrames= 20, fingersOccluded=fingersOccluded, framesOccluded=framesOccluded))
testTrial$indexXbw <- with(testTrial, kin.bwFilter(indexXrep, cutoff_freq = 10, type = "pass"))
testTrial$indexYbw <- with(testTrial, kin.bwFilter(indexYrep, cutoff_freq = 10, type = "pass"))
testTrial$indexZbw <- with(testTrial, kin.bwFilter(indexZrep, cutoff_freq = 10, type = "pass"))
testTrial$thumbXbw <- with(testTrial, kin.bwFilter(thumbXrep, cutoff_freq = 10, type = "pass"))
testTrial$thumbYbw <- with(testTrial, kin.bwFilter(thumbYrep, cutoff_freq = 10, type = "pass"))
testTrial$thumbZbw <- with(testTrial, kin.bwFilter(thumbZrep, cutoff_freq = 10, type = "pass"))
ggplot(data = testTrial) +
geom_point(aes(frameN, thumbXrep), color = "black") +
geom_point(aes(frameN, thumbXbw), color = "red", alpha=.5)
testTrial$indexXsg <- with(testTrial, kin.sgFilter(indexXrep, ts = 1/85))
testTrial$indexYsg <- with(testTrial, kin.sgFilter(indexYrep, ts = 1/85))
testTrial$indexZsg <- with(testTrial, kin.sgFilter(indexZrep, ts = 1/85))
testTrial$thumbXsg <- with(testTrial, kin.sgFilter(thumbXrep, ts = 1/85))
testTrial$thumbYsg <- with(testTrial, kin.sgFilter(thumbYrep, ts = 1/85))
testTrial$thumbZsg <- with(testTrial, kin.sgFilter(thumbZrep, ts = 1/85))
ggplot(data = testTrial) +
geom_point(aes(frameN, thumbXrep), color = "black") +
geom_point(aes(frameN, thumbXsg), color = "green", alpha=.5)
qplot(indexXbw-indexXrep, indexXsg-indexXrep, data=testTrial, geom="point") + coord_fixed()
qplot(thumbXbw-thumbXrep, thumbXsg-thumbXrep, data=testTrial, geom="point") + coord_fixed()
testTrial$indexX <- testTrial$indexXsg
testTrial$indexY <- testTrial$indexYsg
testTrial$indexZ <- testTrial$indexZsg
testTrial$thumbX <- testTrial$thumbXsg
testTrial$thumbY <- testTrial$thumbYsg
testTrial$thumbZ <- testTrial$thumbZsg
km.res <- as.data.frame(kmeans(na.omit(testTrial)[,c("time","indexX","indexY","indexZ","thumbX","thumbY","thumbZ")], 2)$centers)
km.res$moment <- with(km.res, ifelse(time == min(time), "start", "end"))
ind.Zdir <- with(km.res, indexZ[moment=="end"]) - with(km.res, indexZ[moment=="start"])
thu.Zdir <- with(km.res, thumbZ[moment=="end"]) - with(km.res, thumbZ[moment=="start"])
km.res
3.74-1.52
ggplot(aes(thumbX, thumbZ), data=testTrial) + geom_point() + ccord_fixed()
ggplot(aes(thumbX, thumbZ), data=testTrial) + geom_point() + coord_fixed()
?rotate3d()
testTrial[c("thumbX","thumbZ")]
test <- rotate3d(testTrial[c("thumbX","thumbZ")], pi/2, 0, 1, 0)
test <- rotate3d(as.matrix(testTrial[c("thumbX","thumbZ")]), pi/2, 0, 1, 0)
as.matrix(testTrial[c("thumbX","thumbZ")])
as.matrix(testTrial[,c("thumbX","thumbZ")])
test <- rotate3d(as.matrix(testTrial[,c("thumbX","thumbZ")]), pi/2, 0, 1, 0)
test <- rotate3d(t(as.matrix(testTrial[,c("thumbX","thumbZ")])), pi/2, 0, 1, 0)
test <- rotate3d(testTrial[,c("thumbX")])), pi/2, 0, 1, 0)
test <- rotate3d(testTrial[,c("thumbX")]), pi/2, 0, 1, 0)
test <- rotate3d(testTrial[,c("thumbX")], pi/2, 0, 1, 0)
testTrial[,c("thumbX")]
v <- testTrial[,c("thumbX")]
v
test <- rotate3d(v, pi/2, 0, 1, 0)
test <- rotate3d(c(2, 0, 0), pi/2, 0, 1, 0)
v <- testTrial[,c("thumbX","thumbY","thumbZ")]
test <- rotate3d(c(2, 0, 0), pi/2, 0, 1, 0)
test
v
v <- t(testTrial[,c("thumbX","thumbY","thumbZ")])
test <- rotate3d(v, pi/2, 0, 1, 0)
v
v <- t(t(testTrial[,c("thumbX","thumbY","thumbZ")]))
v
test <- rotate3d(v, pi/2, 0, 1, 0)
test
v <- testTrial[,c("thumbX","thumbY","thumbZ")]
test <- rotate3d(v, pi/2, 0, 1, 0)
v
test <- rotate3d(v, pi/2, 0, 1, 0)
v <- as.matrix(testTrial[,c("thumbX","thumbY","thumbZ")])
test <- rotate3d(v, pi/2, 0, 1, 0)
test
head(test)
names(test) <- c("thumbX","thumbY","thumbZ")
ggplot(aes(thumbX, thumbZ), data=test) + geom_point() + coord_fixed()
names(test) <- c("thumbX","thumbY","thumbZ")
names(test)
test
v <- as.matrix(testTrial[,c("thumbX","thumbY","thumbZ")])
test <- rotate3d(v, pi/2, 0, 1, 0)
names(test)
test
test <- as.data.frame(rotate3d(v, pi/2, 0, 1, 0))
names(test)
names(test) <- c("thumbX","thumbY","thumbZ")
ggplot(aes(thumbX, thumbZ), data=test) + geom_point() + coord_fixed()
km.res
rotData <- testTrial[,c(,"indexX","indexY","indexZ","thumbX","thumbY","thumbZ")]
rotData <- testTrial[,c("indexX","indexY","indexZ","thumbX","thumbY","thumbZ")]
ggplot(aes(thumbX, thumbZ), data=rotData) + geom_point() + coord_fixed()
km.res[km.res$moment=="start",c("indexX","indexY","indexZ")]
rotData <- cbind(rotData[,c("indexX","indexY","indexZ")] - km.res[km.res$moment=="start",c("indexX","indexY","indexZ")])
km.res[km.res$moment=="start",c("indexX","indexY","indexZ")]
km.res[km.res$moment=="start",c("indexX","indexY","indexZ")]
index_translate <- km.res[km.res$moment=="start",c("indexX","indexY","indexZ")]
seq_len(nrow(index_translate))
index_translate[rep(1, nrow(rotData))]
index_translate[rep(1, nrow(rotData)),]
index_translate <- index_translate[rep(1, nrow(rotData)),]
rotData <- cbind(rotData[,c("indexX","indexY","indexZ")] - index_translate)
names(rotData)
rotData <- testTrial[,c("indexX","indexY","indexZ","thumbX","thumbY","thumbZ")]
rotData <- cbind(rotData, rotData[,c("indexX","indexY","indexZ")] - index_translate)
names(rotData)
names(rotData)[7:9] <- paste(names(rotData)[1:3], "t", sep="")
names(rotData)
ggplot(data=rotData) +
geom_point(aes(thumbX, thumbZ)) +
geom_point(aes(thumbXt, thumbZt), color = "gray") +
coord_fixed()
ggplot(data=rotData) +
geom_point(aes(indexX, indexZ)) +
geom_point(aes(indexXt, indexZt), color = "gray") +
coord_fixed()
index_translate
ggplot(data=rotData) +
geom_point(aes(indexX, indexY)) +
geom_point(aes(indexXt, indexYt), color = "gray") +
coord_fixed()
thumb_translate <- km.res[km.res$moment=="start",c("thumbX","thumbY","thumbZ")]
thumb_translate <- thumb_translate[rep(1, nrow(rotData)),]
rotData <- cbind(rotData, rotData[,c("thumbX","thumbY","thumbZ")] - thumb_translate)
names(rotData)
names(rotData)[10:12] <- paste(names(rotData)[1:3], "t", sep="")
names(rotData)
theta.t <- with(subset(km.res, moment=="end"), atan(indexX/indexZ))*180/pi
theta.t
theta.t <- with(subset(km.res, moment=="end"), atan(indexX/indexZ)*180/pi)
theta.t
subset(km.res, moment=="end")
km.res
(indexX[moment=="end"]-indexX[moment=="start"])
theta.t <- with(km.res, atan((indexX[moment=="end"]-indexX[moment=="start"])/(indexZ[moment=="end"]-indexZ[moment=="start"]))*180/pi)
theta.t
theta.t <- with(km.res, atan((indexX[moment=="end"]-indexX[moment=="start"])/(indexZ[moment=="end"]-indexZ[moment=="start"])))
v <- as.matrix(rotData[,c("indexX","indexY","indexZ")])
test <- as.data.frame(rotate3d(v, theta.t, 0, 1, 0))
names(test) <- paste(c("indexX","indexY","indexZ"), "r", sep="")
test
names(test)
ggplot() +
geom_point(aes(indexX, indexZ), data=rotData) +
geom_point(aes(indexXr, indexZr), color = "red", data=test) +
coord_fixed()
index_translate <- km.res[km.res$moment=="start",c("indexX","indexY","indexZ")]/2
index_translate <- index_translate[rep(1, nrow(rotData)),]
rotData <- cbind(rotData, rotData[,c("indexX","indexY","indexZ")] - index_translate)
names(rotData)[7:9] <- paste(names(rotData)[1:3], "t", sep="")
theta.t <- with(km.res, atan((indexX[moment=="end"]-indexX[moment=="start"])/(indexZ[moment=="end"]-indexZ[moment=="start"])))
v <- as.matrix(rotData[,c("indexX","indexY","indexZ")])
test <- as.data.frame(rotate3d(v, theta.t, 0, 1, 0))
names(test) <- paste(c("indexX","indexY","indexZ"), "r", sep="")
ggplot() +
geom_point(aes(indexX, indexZ), data=rotData) +
geom_point(aes(indexXr, indexZr), color = "red", data=test) +
coord_fixed()
index_translate
rotData <- testTrial[,c("indexX","indexY","indexZ","thumbX","thumbY","thumbZ")]
index_translate <- km.res[km.res$moment=="start",c("indexX","indexY","indexZ")]/2
index_translate <- index_translate[rep(1, nrow(rotData)),]
rotData <- cbind(rotData, rotData[,c("indexX","indexY","indexZ")] - index_translate)
names(rotData)[7:9] <- paste(names(rotData)[1:3], "t", sep="")
thumb_translate <- km.res[km.res$moment=="start",c("thumbX","thumbY","thumbZ")]
thumb_translate <- thumb_translate[rep(1, nrow(rotData)),]
rotData <- cbind(rotData, rotData[,c("thumbX","thumbY","thumbZ")] - thumb_translate)
names(rotData)[10:12] <- paste(names(rotData)[1:3], "t", sep="")
theta.t <- with(km.res, atan((indexX[moment=="end"]-indexX[moment=="start"])/(indexZ[moment=="end"]-indexZ[moment=="start"])))
v <- as.matrix(rotData[,c("indexX","indexY","indexZ")])
test <- as.data.frame(rotate3d(v, theta.t, 0, 1, 0))
names(test) <- paste(c("indexX","indexY","indexZ"), "r", sep="")
ggplot() +
geom_point(aes(indexX, indexZ), data=rotData) +
geom_point(aes(indexXr, indexZr), color = "red", data=test) +
coord_fixed()
rotData <- testTrial[,c("indexX","indexY","indexZ","thumbX","thumbY","thumbZ")]
index_translate <- km.res[km.res$moment=="start",c("indexX","indexY","indexZ")]
index_translate <- index_translate[rep(1, nrow(rotData)),]
rotData <- cbind(rotData, rotData[,c("indexX","indexY","indexZ")] - index_translate)
names(rotData)[7:9] <- paste(names(rotData)[1:3], "t", sep="")
thumb_translate <- km.res[km.res$moment=="start",c("thumbX","thumbY","thumbZ")]
thumb_translate <- thumb_translate[rep(1, nrow(rotData)),]
rotData <- cbind(rotData, rotData[,c("thumbX","thumbY","thumbZ")] - thumb_translate)
names(rotData)[10:12] <- paste(names(rotData)[1:3], "t", sep="")
theta.t <- with(km.res, atan((indexX[moment=="end"]-indexX[moment=="start"])/(indexZ[moment=="end"]-indexZ[moment=="start"])))
v <- as.matrix(rotData[,c("indexXt","indexYt","indexZt")])
test <- as.data.frame(rotate3d(v, theta.t, 0, 1, 0))
names(test) <- paste(c("indexX","indexY","indexZ"), "r", sep="")
ggplot() +
geom_point(aes(indexX, indexZ), data=rotData) +
geom_point(aes(indexXr, indexZr), color = "red", data=test) +
coord_fixed()
test <- as.data.frame(rotate3d(v, -theta.t, 0, 1, 0))
names(test) <- paste(c("indexX","indexY","indexZ"), "r", sep="")
ggplot() +
geom_point(aes(indexX, indexZ), data=rotData) +
geom_point(aes(indexXr, indexZr), color = "red", data=test) +
coord_fixed()
test <- as.data.frame(rotate3d(v, 180-theta.t, 0, 1, 0))
names(test) <- paste(c("indexX","indexY","indexZ"), "r", sep="")
ggplot() +
geom_point(aes(indexX, indexZ), data=rotData) +
geom_point(aes(indexXr, indexZr), color = "red", data=test) +
coord_fixed()
test <- as.data.frame(rotate3d(v, theta.t+180, 0, 1, 0))
names(test) <- paste(c("indexX","indexY","indexZ"), "r", sep="")
ggplot() +
geom_point(aes(indexX, indexZ), data=rotData) +
geom_point(aes(indexXr, indexZr), color = "red", data=test) +
coord_fixed()
test <- as.data.frame(rotate3d(v, theta.t-180, 0, 1, 0))
names(test) <- paste(c("indexX","indexY","indexZ"), "r", sep="")
ggplot() +
geom_point(aes(indexX, indexZ), data=rotData) +
geom_point(aes(indexXr, indexZr), color = "red", data=test) +
coord_fixed()
test <- as.data.frame(rotate3d(v, theta.t, 0, 1, 0))
names(test) <- paste(c("indexX","indexY","indexZ"), "r", sep="")
ggplot() +
geom_point(aes(indexX, indexZ), data=rotData) +
geom_point(aes(indexXr, indexZr), color = "red", data=test) +
coord_fixed()
test <- as.data.frame(rotate3d(v, theta.t+180, 0, 1, 0))
names(test) <- paste(c("indexX","indexY","indexZ"), "r", sep="")
ggplot() +
geom_point(aes(indexX, indexZ), data=rotData) +
geom_point(aes(indexXr, indexZr), color = "red", data=test) +
coord_fixed()
test <- as.data.frame(rotate3d(v, theta.t, 0, 1, 0))
test <- as.data.frame(rotate3d(test, 180, 0, 1, 0))
test
test <- as.data.frame(rotate3d(as.matrix(test), 180, 0, 1, 0))
names(test) <- paste(c("indexX","indexY","indexZ"), "r", sep="")
ggplot() +
geom_point(aes(indexX, indexZ), data=rotData) +
geom_point(aes(indexXr, indexZr), color = "red", data=test) +
coord_fixed()
test <- as.data.frame(rotate3d(v, theta.t, 0, 1, 0))
names(test) <- paste(c("indexX","indexY","indexZ"), "r", sep="")
ggplot() +
geom_point(aes(indexX, indexZ), data=rotData) +
geom_point(aes(indexXr, indexZr), color = "red", data=test) +
coord_fixed()
test <- as.data.frame(rotate3d(v, 2*theta.t, 0, 1, 0))
names(test) <- paste(c("indexX","indexY","indexZ"), "r", sep="")
ggplot() +
geom_point(aes(indexX, indexZ), data=rotData) +
geom_point(aes(indexXr, indexZr), color = "red", data=test) +
coord_fixed()
test <- as.data.frame(rotate3d(v, theta.t+pi, 0, 1, 0))
names(test) <- paste(c("indexX","indexY","indexZ"), "r", sep="")
ggplot() +
geom_point(aes(indexX, indexZ), data=rotData) +
geom_point(aes(indexXr, indexZr), color = "red", data=test) +
coord_fixed()
theta.s <- with(km.res, atan((indexY[moment=="end"]-indexY[moment=="start"])/(indexZ[moment=="end"]-indexZ[moment=="start"])))
theta.f <- with(km.res, atan((indexX[moment=="end"]-indexX[moment=="start"])/(indexY[moment=="end"]-indexY[moment=="start"])))
rot.tr <- as.matrix(rotData[,c("indexXt","indexYt","indexZt")])
test <- as.data.frame(rotate3d(rot.tr, theta.t+pi, 0, 1, 0))
names(test) <- paste(c("indexX","indexY","indexZ"), "r", sep="")
rot.tr <- as.matrix(rotData[,c("indexXt","indexYt","indexZt")])
test <- as.data.frame(rotate3d(rot.tr, theta.t, 0, 1, 0))
names(test) <- paste(c("indexX","indexY","indexZ"), "r", sep="")
ind.Zdir <- with(km.res, indexZ[moment=="end"]) - with(km.res, indexZ[moment=="start"])
thu.Zdir <- with(km.res, thumbZ[moment=="end"]) - with(km.res, thumbZ[moment=="start"])
ind.Zdir <- with(km.res, indexZ[moment=="end"]) - with(km.res, indexZ[moment=="start"])
thu.Zdir <- with(km.res, thumbZ[moment=="end"]) - with(km.res, thumbZ[moment=="start"])
if(ind.Zdir < 0)
test$indexZr <- test$indexZr*-1
ggplot() +
geom_point(aes(indexX, indexZ), data=rotData) +
geom_point(aes(indexXr, indexZr), color = "red", data=test) +
coord_fixed()
ind.tr <- as.matrix(rotData[,c("indexXt","indexYt","indexZt")])
ind.tr <- as.data.frame(rotate3d(ind.tr, theta.t, 0, 1, 0))
names(ind.tr) <- paste(c("indexX","indexY","indexZ"), "r", sep="")
ggplot() +
geom_point(aes(indexX, indexZ), data=rotData) +
geom_point(aes(indexXr, indexZr), color = "red", data=ind.tr) +
coord_fixed()
if(ind.Zdir < 0)
ind.tr$indexZr <- test$indexZr*-1
ggplot() +
geom_point(aes(indexX, indexZ), data=rotData) +
geom_point(aes(indexXr, indexZr), color = "red", data=ind.tr) +
coord_fixed()
if(ind.Zdir < 0)
ind.tr$indexZr <- ind.tr$indexZr*-1
ggplot() +
geom_point(aes(indexX, indexZ), data=rotData) +
geom_point(aes(indexXr, indexZr), color = "red", data=ind.tr) +
coord_fixed()
ind.tr <- as.matrix(rotData[,c("indexXt","indexYt","indexZt")])
ind.tr <- as.data.frame(rotate3d(ind.tr, theta.s, 1, 0, 0))
ind.tr <- as.data.frame(rotate3d(ind.tr, theta.t, 0, 1, 0))
ind.tr <- as.matrix(rotData[,c("indexXt","indexYt","indexZt")])
ind.tr <- as.matrix(rotData[,c("indexXt","indexYt","indexZt")])
ind.tr <- as.data.frame(rotate3d(ind.tr, theta.s, 1, 0, 0))
ind.tr <- as.data.frame(rotate3d(as.matrix(ind.tr), theta.t, 0, 1, 0))
ind.tr <- as.data.frame(rotate3d(as.matrix(ind.tr), theta.f, 0, 0, 1))
names(ind.tr) <- paste(c("indexX","indexY","indexZ"), "r", sep="")
ind.Zdir <- with(km.res, indexZ[moment=="end"]) - with(km.res, indexZ[moment=="start"])
thu.Zdir <- with(km.res, thumbZ[moment=="end"]) - with(km.res, thumbZ[moment=="start"])
if(ind.Zdir < 0)
ind.tr$indexZr <- ind.tr$indexZr*-1
ggplot() +
geom_point(aes(indexX, indexZ), data=rotData) +
geom_point(aes(indexXr, indexZr), color = "red", data=ind.tr) +
coord_fixed()
ind.tr <- as.matrix(rotData[,c("indexXt","indexYt","indexZt")])
ind.tr <- as.data.frame(rotate3d(ind.tr, theta.t, 0, 1, 0))
names(ind.tr) <- paste(c("indexX","indexY","indexZ"), "r", sep="")
ind.Zdir <- with(km.res, indexZ[moment=="end"]) - with(km.res, indexZ[moment=="start"])
thu.Zdir <- with(km.res, thumbZ[moment=="end"]) - with(km.res, thumbZ[moment=="start"])
if(ind.Zdir < 0)
ind.tr$indexZr <- test$indexZr*-1
ggplot() +
geom_point(aes(indexX, indexZ), data=rotData) +
geom_point(aes(indexXr, indexZr), color = "red", data=ind.tr) +
coord_fixed()
if(ind.Zdir < 0)
ind.tr$indexZr <- ind.tr$indexZr*-1
ggplot() +
geom_point(aes(indexX, indexZ), data=rotData) +
geom_point(aes(indexXr, indexZr), color = "red", data=ind.tr) +
coord_fixed()
